<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Explorer et contrôler vos données d’enquête avec **vizsurvey** • vizsurvey</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Explorer et contrôler vos données d’enquête avec **vizsurvey**">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vizsurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/vizsurvey.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data-preparation.html">data-preparation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdelc/vizsurvey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Explorer et contrôler vos données d’enquête avec **vizsurvey**</h1>
            <h3 data-toc-skip class="subtitle">Vignette 1 — Guide pas à
pas pour fouiller et détecter les anomalies</h3>
                        <h4 data-toc-skip class="author">Équipe
méthodologie — vizsurvey</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tdelc/vizsurvey/blob/master/vignettes/vizsurvey.Rmd" class="external-link"><code>vignettes/vizsurvey.Rmd</code></a></small>
      <div class="d-none name"><code>vizsurvey.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="pourquoi-vizsurvey-positionnement-gsbpm">Pourquoi vizsurvey ? (positionnement GSBPM)<a class="anchor" aria-label="anchor" href="#pourquoi-vizsurvey-positionnement-gsbpm"></a>
</h3>
<p>Dans un processus statistique conforme au GSBPM, la qualité ne se
joue pas uniquement en amont (échantillonnage, questionnaire, collecte)
ni en aval (analyse, diffusion). Entre collecte et analyse, une phase
clé consiste à contrôler et monitorer le matériau collecté pour repérer
rapidement les anomalies, documenter les écarts et, si nécessaire,
déclencher des actions correctrices.</p>
<p>vizsurvey répond à cette problématique : il offre une interface
interactive pour parcourir vos données, comparer des profils de réponses
et prioriser les investigations. L’objectif n’est pas de conclure
statistiquement, mais de guider le regard de l’analyste avec des
indicateurs simples (distances, rangs) et des visualisations
adaptées.</p>
</div>
<div class="section level3">
<h3 id="effets-enquêteurrice">Effets <strong>enquêteur·rice</strong><a class="anchor" aria-label="anchor" href="#effets-enqu%C3%AAteurrice"></a>
</h3>
<p>Le rôle des enquêteur·rices est <strong>central</strong> :
compréhension fine du questionnaire, respect du routage, gestion de
l’entretien. Il peut néanmoins apparaître des <strong>effets
enquêteur</strong> (différences systématiques de distribution des
réponses selon la personne qui interroge), dus à des styles
d’administration, des biais involontaires, des erreurs récurrentes ou,
plus rarement, à de la fraude.</p>
<p>Sur ce sujet, <strong>vizsurvey</strong> permet de :</p>
<ul>
<li><p><strong>Comparer</strong> les distributions de réponses d’un·e
enquêteur·rice à <strong>tous les autres</strong> ;</p></li>
<li><p><strong>Classer</strong> les personnes selon plusieurs
indicateurs de distance ;</p></li>
<li><p><strong>Focaliser</strong> l’examen sur les combinaisons
enquêteur·rice × variable <strong>les plus atypiques</strong>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="cohérence-dune-année-à-lautre">Cohérence <strong>d’une année à l’autre</strong><a class="anchor" aria-label="anchor" href="#coh%C3%A9rence-dune-ann%C3%A9e-%C3%A0-lautre"></a>
</h3>
<p>D’une année à l’autre, les questionnaires évoluent (libellés,
routage, filtres), mais les <strong>variables cibles</strong> doivent
rester <strong>comparables</strong>. <strong>vizsurvey</strong> met en
évidence :</p>
<ul>
<li><p>les <strong>écarts</strong> de distributions ou de niveaux
(proportions, moyennes) ;</p></li>
<li><p>les variables présentant des <strong>ruptures</strong> qui
méritent une relecture (mise en œuvre du routage, recodages,
versionnement du questionnaire, changement de collecte, etc.).</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="lancement-vizsurvey">Lancement vizsurvey<a class="anchor" aria-label="anchor" href="#lancement-vizsurvey"></a>
</h2>
<p>Il y a trois manières de lancer {vizsurvey} : à partir d’une base de
données en R (<code>runVizsurvey_from_r</code>), à partir d’un fichier
csv (<code>runVizsurvey_from_file</code>), ou en préparant une structure
de fichier pour analyser en simultané plusieurs enquêtes
(<code>runVizsurvey_from_folder</code>). Nous allons ici nous intéresser
aux deux premiers cas.</p>
<p>Le package {laeken} fournit un fichier d’exemple de l’enquête SILC
(survey on income and living condition). Nous pouvons prendre ce fichier
comme exemple, et venir créer un numéro d’enquêteur-rice à partir de la
variable de province <code>DB040</code>. Nous exécutons la fonction
<code>runVizsurvey_from_r</code> avec comme argument supplémentaire
<code>var_group = "DB040"</code> afin de prévoir des subdivisions du
travail de terrain par province.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdelc/vizsurvey" class="external-link">vizsurvey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">laeken</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">eusilc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">eusilc</span> <span class="op">&lt;-</span> <span class="va">eusilc</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>NR_ITW <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">db040</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runVizsurvey_from_r.html">runVizsurvey_from_r</a></span><span class="op">(</span><span class="va">eusilc</span>,var_itw <span class="op">=</span> <span class="st">"NR_ITW"</span>,var_group <span class="op">=</span> <span class="st">"db040"</span><span class="op">)</span></span></code></pre></div>
<p>Si vous avez lancé les packages nécessaires, une interface shiny doit
se lancer dans votre navigateur, et afficher cette carte de chaleur.
Celle-ci est le coeur du fonctionnement de vizsurvey, car elle permet de
naviguer de manière interactive à travers les situations détectées comme
anormales.</p>
<p><img src="images/clipboard-3454725579.png"></p>
<p>Chaque ligne est un ou une enquêtrice. Ici, nous reconnaissons les
provinces australiennes avec un index, issu de notre simulation de
numéro. Chaque colonne est une variable, catégorielle ou continue.
Chaque cellule est colorée si les réponses de l’enquêteur-rice pour
cette variable est suffisamment différentes des réponses du reste de la
base de données.</p>
<ul>
<li><p>Pour les variables catégorielles, il peut s’agir d’un écart trop
important sur le pourcentage de données manquantes, ou d’un
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>χ</mi><mi>²</mi></mrow><annotation encoding="application/x-tex">\chi²</annotation></semantics></math>
trop élevé (donc d’une distribution très éloigné du reste de la base de
données) ;</p></li>
<li><p>Pour les variables numériques, il peut s’agir d’un écart trop
important sur le pourcentage de données manquantes, ou d’une écart trop
important sur la médiane.</p></li>
</ul>
<p>Eu survolant les cellules, toutes les informations sont affichées, de
sorte à comprendre la source de la coloration. Voici une première
manière d’analyser la carte de chaleur :</p>
<ul>
<li><p>Une <strong>cellule isolée</strong> “chaude” n’est pas
problématique en soi — avec beaucoup de croisements, il est
<strong>normal</strong> d’observer quelques extrêmes.</p></li>
<li><p>Une <strong>ligne</strong> largement “chaude” (plusieurs
variables) évoque un <strong>comportement récurrent</strong> (erreur de
procédure, incompréhension, routage mal appliqué, voire
fraude).</p></li>
<li><p>Une <strong>colonne</strong> “chaude” (plusieurs enquêteur-rices)
pointe une <strong>variable fragile</strong> (libellé ambigu, routing,
aide à l’enquêteur, effet d’une zone).</p></li>
</ul>
<p>Dans notre exemple, plusieurs cellules s’allument en rouge pour la
région de Vienne. En cliquant sur le croisement Vienne-1 / HHSIZE, on
peut afficher la distribution de cette variable HHSIZE pour l’enquêteur
Vienne-1, et le comparer avec la distribution de cette variable pour les
autres. On découvre ainsi que le pourcentage de modalités 3 et 4 sont
bien plus présent chez les autres que chez l’enquêteur Vienne-1.</p>
<p><img src="images/clipboard-4139068194.png"></p>
<p>Ici, on remarque que les 5 lignes de Vienne sont allumées en rouge,
preuve d’un effet de zone plutôt qu’un effet d’enquêteur·rice. Pour s’en
convaincre, on peut sélectionner DB040 = Vienne en haut de l’interface.
Dès lors, la carte de chaleur se limite aux données de Vienne, et
n’affiche que les écarts des enquêteur-rices par rapport à cette
province. Il n’y a plus aucune cellule s’affichant en rouge ainsi.</p>
<p><img src="images/clipboard-1042724936.png"></p>
<p>Lorsqu’on clique sur une variable numérique, la fonction de densité
s’affiche alors, toujours avec le point de comparaison. Voici un exemple
pour la variable d’âge pour l’enquêtrice Carinthia-5 :</p>
<p><img src="images/clipboard-4047038565.png"></p>
<div class="section level4">
<h4 id="pas-à-pas-volet-enquêteurs">Pas à pas — volet enquêteurs<a class="anchor" aria-label="anchor" href="#pas-%C3%A0-pas-volet-enqu%C3%AAteurs"></a>
</h4>
<ol style="list-style-type: decimal">
<li><p><strong>Sélectionner</strong> l’enquête et la période (ex.
semaine N, vague t).</p></li>
<li><p><strong>Choisir</strong> l’onglet <em>Enquêteurs</em> puis une
<strong>famille de variables</strong> (catégorielles /
continues).</p></li>
<li><p><strong>Parcourir la heatmap</strong> enquêteur·rice × variable
(voir §5) pour repérer les cellules les plus “chaudes”.</p></li>
<li><p><strong>Cliquer</strong> sur une cellule pour ouvrir les
<strong>détails</strong> (barplots, tables de fréquences,
filtres).</p></li>
<li><p><strong>Comparer</strong> l’enquêteur·rice à la
<strong>référence</strong> (tous les autres) et regarder la cohérence
<strong>intra-variable</strong> (modalités) et
<strong>inter-variables</strong> (corrélations).</p></li>
<li><p><strong>Consigner</strong> les cas récurrents (mêmes écarts sur
plusieurs variables ou dans le temps).</p></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">eusilc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">eusilc</span> <span class="op">&lt;-</span> <span class="fl">2024</span><span class="op">:</span><span class="fl">2025</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="op">~</span><span class="op">{</span></span>
<span>  <span class="va">eusilc</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>db010 <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eusilc</span> <span class="op">&lt;-</span> <span class="va">eusilc</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>eqSS <span class="op">=</span> <span class="va">eqSS</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">db010</span> <span class="op">==</span> <span class="fl">2025</span><span class="op">)</span>,</span>
<span>         pb220a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">db010</span> <span class="op">==</span> <span class="fl">2025</span> <span class="op">&amp;</span> <span class="va">pb220a</span> <span class="op">==</span> <span class="st">"AT"</span>,<span class="cn">NA</span>,<span class="va">pb220a</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/runVizsurvey_from_r.html">runVizsurvey_from_r</a></span><span class="op">(</span><span class="va">eusilc</span>,var_itw <span class="op">=</span> <span class="st">"NR_ITW"</span>,</span>
<span>                    var_domain <span class="op">=</span> <span class="st">"db010"</span>, var_group <span class="op">=</span> <span class="st">"db040"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="indicateurs-calculés-sans-test-statistique">Indicateurs calculés (sans test statistique)<a class="anchor" aria-label="anchor" href="#indicateurs-calcul%C3%A9s-sans-test-statistique"></a>
</h2>
<blockquote>
<p><strong>Principe directeur</strong> : aucun <strong>test</strong>
n’est effectué. <strong>vizsurvey</strong> calcule des
<strong>distances</strong>, des <strong>scores</strong> et des
<strong>rangs</strong> destinés à <strong>prioriser</strong> la revue.
Les conclusions analytiques restent du ressort de l’équipe
méthodologique.</p>
</blockquote>
<div class="section level3">
<h3 id="distance-de-type-χ²-pour-variables-catégorielles-effets-enquêteurrice">Distance de type <strong>χ²</strong> pour variables catégorielles
(effets enquêteur·rice)<a class="anchor" aria-label="anchor" href="#distance-de-type-%CF%87%C2%B2-pour-variables-cat%C3%A9gorielles-effets-enqu%C3%AAteurrice"></a>
</h3>
<p>Pour chaque variable catégorielle et chaque enquêteur-rice, on
compare la distribution observée chez lui ou elle à celle de la
<strong>référence</strong> (tous-tes les enquêteur·rices). On calcule un
<strong>χ² de distance</strong> (de type Pearson) :</p>
<ul>
<li><p>Un <strong>χ² élevé</strong> signale un <strong>profil
atypique</strong> sur cet-te enquêteur-rice.</p></li>
<li><p>Les valeurs sont <strong>affichées</strong> par enquêteur-rice et
variable ;</p></li>
</ul>
<blockquote>
<p><em>Bonnes pratiques</em> : filtrer les <strong>petits
effectifs</strong>, fixer un <strong>seuil minimal</strong>
d’observations, travailler sur des variables <strong>propres</strong>
(NA explicites, modalités cohérentes).</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="différences-inter-annuelles-standardisation-simple">Différences <strong>inter-annuelles</strong> (standardisation
simple)<a class="anchor" aria-label="anchor" href="#diff%C3%A9rences-inter-annuelles-standardisation-simple"></a>
</h3>
<p>Pour comparer deux domaines (souvent des années),
<strong>vizsurvey</strong> calcule, selon le type de variable :</p>
<ul>
<li><p><strong>Catégorielles</strong> : différence du pourcentage de
données manquantes ; différence relative du nombre de modalités
;</p></li>
<li><p><strong>Continues</strong> : différence du pourcentage de données
manquantes ; différence relative de la moyenne et de la médiane
;</p></li>
</ul>
<p>Dès qu’un score est supérieur à un seuil, la variable est affichée,
et sa distribution de l’année en cours et des différentes années testées
sont affichées. Ils <strong>n’impliquent pas</strong> de décision
statistique (pas de p-valeur), mais <strong>orientent</strong> la
revue.</p>
</div>
<div class="section level3">
<h3 id="classer-pour-prioriser-isolation-forest-sur-profils-de-distances">Classer pour prioriser : <strong>Isolation Forest</strong> sur
profils de distances<a class="anchor" aria-label="anchor" href="#classer-pour-prioriser-isolation-forest-sur-profils-de-distances"></a>
</h3>
<p>Quand le volume de croisements est important, il est difficile de
savoir <strong>où commencer</strong>. <strong>vizsurvey</strong> propose
un classement <strong>enquêteur·rices</strong> via un modèle
<strong>Isolation Forest</strong> appliqué aux <strong>vecteurs de
χ²</strong> (une composante par variable catégorielle).</p>
<ul>
<li><p><strong>Idée</strong> : un profil “atypique” est <strong>plus
facile à isoler</strong> dans l’espace des distances.</p></li>
<li><p><strong>Entrées</strong> : pour chaque enquêteur·rice, un vecteur
(χ2(V1),χ2(V2),…)(^2(V_1), ^2(V_2), )(χ2(V1​),χ2(V2​),…), éventuellement
<strong>standardisé</strong> et <strong>tronqué</strong> (winsorisation)
pour limiter l’influence des très grands χ² dus à de minuscules
effectifs.</p></li>
<li><p><strong>Sortie</strong> : un <strong>score d’anomalie</strong>
(continu) permettant de <strong>trier</strong> les personnes à examiner
<strong>en premier</strong>.</p></li>
</ul>
<blockquote>
<p><em>Important</em> : ce classement <strong>n’est pas une
preuve</strong>. Il <strong>priorise</strong> l’audit (lecture ciblée
des variables responsables, vérification du contexte terrain, contrôle
croisé avec le suivi qualité).</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="limites-et-responsabilités">Limites et responsabilités<a class="anchor" aria-label="anchor" href="#limites-et-responsabilit%C3%A9s"></a>
</h2>
<ul>
<li><p><strong>vizsurvey</strong> <strong>n’infère</strong> rien : il
<strong>organise</strong> l’exploration.</p></li>
<li><p>Les <strong>interprétations</strong> doivent s’appuyer sur le
<strong>contexte</strong> (terrain, consignes, scripts, logs).</p></li>
<li><p>Les <strong>données sensibles</strong> (enquêteur·rices, ménages)
doivent être traitées conformément aux règles de
<strong>confidentialité</strong>.</p></li>
</ul>
<div class="section level3">
<h3 id="introduction-1">Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"></a>
</h3>
<p>Ce tutoriel présente un enchaînement complet allant de la préparation
de vos données jusqu’à l’exploration de l’application Shiny fournie par
<strong>vizsurvey</strong> pour analyser les effets enquêteur. Il
s’adresse à des utilisateurs disposant d’un corpus d’entretiens enquêtés
et d’un fichier de configuration décrivant les variables clés.</p>
<p>Au fil des sections, vous apprendrez à :</p>
<ul>
<li>préparer l’arborescence de données avec <code><a href="../reference/prepa_survey.html">prepa_survey()</a></code>
;</li>
<li>lancer le tableau de bord <code>runVizsurvey_*()</code> ;</li>
<li>tirer parti des fonctions utilitaires comme
<code><a href="../reference/prepa_stats.html">prepa_stats()</a></code> ou <code><a href="../reference/score_isoforest.html">score_isoforest()</a></code> ;</li>
<li>résoudre les problèmes courants rencontrés lors de
l’importation.</li>
</ul>
<p>Nous utiliserons des exemples reproductibles que vous pourrez adapter
à votre propre projet.</p>
</div>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Depuis CRAN (lorsque disponible)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"vizsurvey"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ou depuis GitHub pour la version de développement</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tdelc/vizsurvey"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Packages suggérés</strong> :</p>
<ul>
<li>
<code>shiny</code> et <code>shinydashboard</code> pour l’interface
;</li>
<li>
<code>isotree</code> pour le score d’isolement ;</li>
<li>
<code>cli</code> et <code>progressr</code> pour le suivi des
traitements ;</li>
<li>
<code>readr</code>, <code>dplyr</code>, <code>tidyr</code> pour la
manipulation des données.</li>
</ul>
<p>Assurez-vous que ces dépendances sont disponibles, surtout si vous
utilisez les fonctionnalités avancées.</p>
</div>
<div class="section level3">
<h3 id="préparer-vos-données">Préparer vos données<a class="anchor" aria-label="anchor" href="#pr%C3%A9parer-vos-donn%C3%A9es"></a>
</h3>
<div class="section level4">
<h4 id="structurer-les-fichiers-dentrée">1. Structurer les fichiers d’entrée<a class="anchor" aria-label="anchor" href="#structurer-les-fichiers-dentr%C3%A9e"></a>
</h4>
<p>L’outil <code><a href="../reference/prepa_survey.html">prepa_survey()</a></code> attend une arborescence de type
:</p>
<pre><code>data/
├── ENQ_1/
│   ├── enquête1_1.csv
│   └── enquête1_2.csv
└── ENQ_2/
    ├── enquête1_1.csv
    └── enquête1_2.csv</code></pre>
<p>Chaque CSV représente les réponses individuelles d’une enquête,
tandis que le fichier YAML correspondant décrit les variables
(identifiants, domaines, modalités, etc.).</p>
<p>Voici un exemple minimal de configuration (fichier
<code>config_enquête1.yml</code>) :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">id_itw</span><span class="kw">:</span><span class="at"> id_interview</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">vt</span><span class="kw">:</span><span class="at"> type_ménage</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">vg</span><span class="kw">:</span><span class="at"> region</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">interviewer</span><span class="kw">:</span><span class="at"> id_enqueteur</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="fu">weight</span><span class="kw">:</span><span class="at"> poids</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">variables</span><span class="kw">:</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> satisfaction</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> numeric</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="at">    </span><span class="fu">label</span><span class="kw">:</span><span class="at"> </span><span class="st">"Score de satisfaction"</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> mode</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> categorical</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="at">    </span><span class="fu">label</span><span class="kw">:</span><span class="at"> </span><span class="st">"Mode de collecte"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="créer-une-configuration-à-partir-dun-gabarit">2. Créer une configuration à partir d’un gabarit<a class="anchor" aria-label="anchor" href="#cr%C3%A9er-une-configuration-%C3%A0-partir-dun-gabarit"></a>
</h4>
<p>Vous pouvez générer un gabarit initial avec
<code><a href="../reference/create_config.html">create_config()</a></code> :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdelc/vizsurvey" class="external-link">vizsurvey</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">template</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_config.html">create_config</a></span><span class="op">(</span></span>
<span>  interviewer <span class="op">=</span> <span class="st">"id_enqueteur"</span>,</span>
<span>  id_itw      <span class="op">=</span> <span class="st">"id_interview"</span>,</span>
<span>  vt          <span class="op">=</span> <span class="st">"type_ménage"</span>,</span>
<span>  vg          <span class="op">=</span> <span class="st">"region"</span>,</span>
<span>  weight      <span class="op">=</span> <span class="st">"poids"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Écrire le gabarit dans un fichier YAML</span></span>
<span><span class="va">config_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".yml"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">template</span>, <span class="va">config_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">config_path</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p>Adaptez ensuite les sections <code>variables</code> pour décrire les
indicateurs que vous souhaitez analyser (numériques, catégoriels ou
binaires).</p>
</div>
<div class="section level4">
<h4 id="lancer-la-préparation">3. Lancer la préparation<a class="anchor" aria-label="anchor" href="#lancer-la-pr%C3%A9paration"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdelc/vizsurvey" class="external-link">vizsurvey</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_dir</span>  <span class="op">&lt;-</span> <span class="st">"mon-projet"</span></span>
<span><span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"prepa"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/prepa_survey.html">prepa_survey</a></span><span class="op">(</span></span>
<span>  input_dir  <span class="op">=</span> <span class="va">input_dir</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">output_dir</span>,</span>
<span>  config     <span class="op">=</span> <span class="st">"configs/config_enquête1.yml"</span>,</span>
<span>  survey     <span class="op">=</span> <span class="st">"data/enquête1.csv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Cette commande :</p>
<ol style="list-style-type: decimal">
<li>lit le CSV de réponses ;</li>
<li>applique les définitions du YAML (typage, filtres éventuels) ;</li>
<li>calcule des statistiques agrégées et les sauvegarde en
<code>.rds</code> ;</li>
<li>journalise l’avancement dans la console via <code>cli</code>.</li>
</ol>
<p>Les fichiers générés (<code>*_stats.rds</code>,
<code>*_meta.rds</code>) serviront directement à alimenter l’application
Shiny.</p>
</div>
</div>
<div class="section level3">
<h3 id="lancer-le-tableau-de-bord">Lancer le tableau de bord<a class="anchor" aria-label="anchor" href="#lancer-le-tableau-de-bord"></a>
</h3>
<div class="section level4">
<h4 id="utiliser-des-données-préparées">Utiliser des données préparées<a class="anchor" aria-label="anchor" href="#utiliser-des-donn%C3%A9es-pr%C3%A9par%C3%A9es"></a>
</h4>
<p>Lorsque les <code>.rds</code> ont été produits, lancez l’application
via :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runVizsurvey_from_folder.html">runVizsurvey_from_folder</a></span><span class="op">(</span><span class="va">output_dir</span><span class="op">)</span></span></code></pre></div>
<p>L’interface Shiny s’ouvre dans votre navigateur et charge
automatiquement les statistiques disponibles dans le dossier.</p>
</div>
<div class="section level4">
<h4 id="importer-un-fichier-csv-à-la-volée">Importer un fichier CSV à la volée<a class="anchor" aria-label="anchor" href="#importer-un-fichier-csv-%C3%A0-la-vol%C3%A9e"></a>
</h4>
<p>Pour explorer rapidement un fichier sans passer par
<code><a href="../reference/prepa_survey.html">prepa_survey()</a></code>, utilisez
<code><a href="../reference/runVizsurvey_from_file.html">runVizsurvey_from_file()</a></code> :</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runVizsurvey_from_file.html">runVizsurvey_from_file</a></span><span class="op">(</span></span>
<span>  file   <span class="op">=</span> <span class="st">"mon-projet/data/enquête1.csv"</span>,</span>
<span>  config <span class="op">=</span> <span class="st">"mon-projet/configs/config_enquête1.yml"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>L’application prépare alors temporairement les données (dans un
répertoire <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code>) et les affiche immédiatement.</p>
</div>
<div class="section level4">
<h4 id="depuis-un-objet-r-déjà-chargé">Depuis un objet R déjà chargé<a class="anchor" aria-label="anchor" href="#depuis-un-objet-r-d%C3%A9j%C3%A0-charg%C3%A9"></a>
</h4>
<p>Si vos données résident déjà en mémoire sous forme de data.frame,
combinez-les avec <code><a href="../reference/runVizsurvey_from_r.html">runVizsurvey_from_r()</a></code> :</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdelc/vizsurvey" class="external-link">vizsurvey</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"mon-projet/data/enquête1.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/runVizsurvey_from_r.html">runVizsurvey_from_r</a></span><span class="op">(</span></span>
<span>  data   <span class="op">=</span> <span class="va">df</span>,</span>
<span>  config <span class="op">=</span> <span class="st">"mon-projet/configs/config_enquête1.yml"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="explorer-linterface">Explorer l’interface<a class="anchor" aria-label="anchor" href="#explorer-linterface"></a>
</h3>
<p>L’application se compose de plusieurs onglets :</p>
<ol style="list-style-type: decimal">
<li>
<strong>Vue d’ensemble</strong> : effectifs globaux, taux de réponse
par enquêteur, filtres interactifs.</li>
<li>
<strong>Classement enquêteurs</strong> : statistiques détaillées
(moyennes, variances, écarts aux médianes) afin d’identifier les profils
atypiques.</li>
<li>
<strong>Cartes de chaleur</strong> : visualisation de
<code><a href="../reference/heat_map_group.html">heat_map_group()</a></code> pour repérer les variables problématiques
par domaine ou sous-groupe.</li>
<li>
<strong>Analyse statistique</strong> : résultats des tests de
khi-deux et d’ANOVA selon la nature des variables.</li>
</ol>
<p>Conseils d’interprétation :</p>
<ul>
<li>Utilisez les filtres (domaine, mode, période) pour isoler des
segments précis.</li>
<li>Comparez les contributions au khi-deux pour déterminer quelles
modalités alimentent les écarts.</li>
<li>Exportez les tableaux via les boutons intégrés lorsque vous
souhaitez partager une photographie de la situation.</li>
</ul>
</div>
<div class="section level3">
<h3 id="allers-retours-analytiques">Allers-retours analytiques<a class="anchor" aria-label="anchor" href="#allers-retours-analytiques"></a>
</h3>
<div class="section level4">
<h4 id="prepa_stats-extraire-les-agrégats">
<code>prepa_stats()</code> : extraire les agrégats<a class="anchor" aria-label="anchor" href="#prepa_stats-extraire-les-agr%C3%A9gats"></a>
</h4>
<p><code><a href="../reference/prepa_stats.html">prepa_stats()</a></code> vous renvoie un data.frame compilant les
statistiques calculées pendant la préparation. Vous pouvez l’utiliser
pour alimenter des rapports ou construire vos propres
visualisations.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepa_stats.html">prepa_stats</a></span><span class="op">(</span><span class="va">output_dir</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="heat_map_group-personnaliser-la-visualisation">
<code>heat_map_group()</code> : personnaliser la visualisation<a class="anchor" aria-label="anchor" href="#heat_map_group-personnaliser-la-visualisation"></a>
</h4>
<p>Pour générer une heatmap hors Shiny :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_group</span> <span class="op">&lt;-</span> <span class="va">stats</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable</span> <span class="op">==</span> <span class="st">"satisfaction"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/heat_map_group.html">heat_map_group</a></span><span class="op">(</span></span>
<span>  <span class="va">data_group</span>,</span>
<span>  group_var   <span class="op">=</span> <span class="st">"vg"</span>,</span>
<span>  interviewer <span class="op">=</span> <span class="st">"interviewer"</span>,</span>
<span>  value       <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Vous pouvez ajuster la palette via l’argument <code>palette</code> et
contrôler les titres à l’aide de <code>title</code> et
<code>subtitle</code>.</p>
</div>
<div class="section level4">
<h4 id="score_isoforest-détecter-les-profils-atypiques">
<code>score_isoforest()</code> : détecter les profils atypiques<a class="anchor" aria-label="anchor" href="#score_isoforest-d%C3%A9tecter-les-profils-atypiques"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">donnees_num</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">iso_scores</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score_isoforest.html">score_isoforest</a></span><span class="op">(</span><span class="va">donnees_num</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iso_scores</span><span class="op">)</span></span></code></pre></div>
<p>Avant de lancer cette fonction, assurez-vous que les colonnes
sélectionnées sont numériques, sans valeurs manquantes excessives.
Standardisez ou filtrez les variables constantes pour éviter des
avertissements.</p>
</div>
</div>
<div class="section level3">
<h3 id="traitements-par-lot">Traitements par lot<a class="anchor" aria-label="anchor" href="#traitements-par-lot"></a>
</h3>
<p>Si vous avez plusieurs enquêtes à traiter dans un répertoire,
<code><a href="../reference/prepa_all_surveys.html">prepa_all_surveys()</a></code> automatisera la boucle :</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prepa_all_surveys.html">prepa_all_surveys</a></span><span class="op">(</span></span>
<span>  input_dir  <span class="op">=</span> <span class="st">"mon-projet"</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">output_dir</span>,</span>
<span>  pattern    <span class="op">=</span> <span class="st">"*.csv"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Chaque jeu de données sera préparé avec le fichier YAML du même nom
(à l’extension près). Surveillez la console pour connaître l’avancement
et les éventuels problèmes rencontrés sur un fichier spécifique.</p>
</div>
<div class="section level3">
<h3 id="résolution-de-problèmes">Résolution de problèmes<a class="anchor" aria-label="anchor" href="#r%C3%A9solution-de-probl%C3%A8mes"></a>
</h3>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Symptôme</th>
<th>Cause probable</th>
<th>Solution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>argument is of length zero</code></td>
<td>Clé absente dans le YAML (<code>vt</code>, <code>vg</code>,
etc.)</td>
<td>Vérifiez la présence des clés et leur orthographe.</td>
</tr>
<tr class="even">
<td><code>object 'write_csv' not found</code></td>
<td>
<code>readr</code> non attaché lors de
<code><a href="../reference/create_fake_silc.html">create_fake_silc()</a></code>
</td>
<td>Chargez <code>readr</code> ou utilisez
<code>readr::write_csv</code>.</td>
</tr>
<tr class="odd">
<td><code>non-numeric argument to binary operator</code></td>
<td>Colonnes non numériques lors d’un calcul</td>
<td>Filtrez avec <code>dplyr::select(where(is.numeric))</code> avant
traitement.</td>
</tr>
<tr class="even">
<td>Heatmap vide</td>
<td>Aucun enregistrement dans la combinaison domaine/groupe</td>
<td>Contrôlez les filtres ou élargissez la période analysée.</td>
</tr>
</tbody>
</table>
<p>Activez les options de diagnostic supplémentaires avec :</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>vizsurvey.verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Cette option affiche des messages détaillés pendant la préparation
pour identifier rapidement les enregistrements problématiques.</p>
</div>
<div class="section level3">
<h3 id="exemple-reproductible-complet">Exemple reproductible complet<a class="anchor" aria-label="anchor" href="#exemple-reproductible-complet"></a>
</h3>
<p>Le bloc ci-dessous illustre un flux complet à partir d’un jeu de
données synthétique :</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdelc/vizsurvey" class="external-link">vizsurvey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1. Générer un exemple fictif</span></span>
<span><span class="va">tmp_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  id_interview <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span>,</span>
<span>  id_enqueteur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"E%02d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  type_ménage  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Solo"</span>, <span class="st">"Couple"</span>, <span class="st">"Famille"</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  region       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Nord"</span>, <span class="st">"Sud"</span>, <span class="st">"Est"</span>, <span class="st">"Ouest"</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  poids        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  satisfaction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">200</span>, mean <span class="op">=</span> <span class="fl">6</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  mode         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Téléphone"</span>, <span class="st">"Face-à-face"</span>, <span class="st">"Web"</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Sauvegarder les fichiers d'entrée</span></span>
<span><span class="va">input_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp_dir</span>, <span class="st">"demo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">input_dir</span>, <span class="st">"data"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">input_dir</span>, <span class="st">"configs"</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu">write_csv</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">input_dir</span>, <span class="st">"data"</span>, <span class="st">"demo.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">config_yaml</span> <span class="op">&lt;-</span> <span class="st">"id_itw: id_interview\ninterviewer: id_enqueteur\nvt: type_ménage\nvg: region\nweight: poids\nvariables:\n  - name: satisfaction\n    type: numeric\n    label: Score de satisfaction\n  - name: mode\n    type: categorical\n    label: Mode de collecte\n"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">config_yaml</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">input_dir</span>, <span class="st">"configs"</span>, <span class="st">"demo.yml"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Préparer les données</span></span>
<span><span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">tmp_dir</span>, <span class="st">"demo_prepa"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/prepa_survey.html">prepa_survey</a></span><span class="op">(</span></span>
<span>  input_dir  <span class="op">=</span> <span class="va">input_dir</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">output_dir</span>,</span>
<span>  config     <span class="op">=</span> <span class="st">"configs/demo.yml"</span>,</span>
<span>  survey     <span class="op">=</span> <span class="st">"data/demo.csv"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Lancer l'application (ouvre un onglet navigateur)</span></span>
<span><span class="fu"><a href="../reference/runVizsurvey_from_folder.html">runVizsurvey_from_folder</a></span><span class="op">(</span><span class="va">output_dir</span><span class="op">)</span></span></code></pre></div>
<p>Cet exemple crée un environnement isolé dans le dossier temporaire de
R, traite les données synthétiques et lance l’application. Adaptez les
noms de variables aux vôtres pour reproduire le processus sur vos
enquêtes réelles.</p>
</div>
<div class="section level3">
<h3 id="ressources-complémentaires">Ressources complémentaires<a class="anchor" aria-label="anchor" href="#ressources-compl%C3%A9mentaires"></a>
</h3>
<ul>
<li>Documentation de référence : <code><a href="../reference/prepa_survey.html">?prepa_survey</a></code>,
<code><a href="../reference/runVizsurvey_from_folder.html">?runVizsurvey_from_folder</a></code>, <code><a href="../reference/prepa_stats.html">?prepa_stats</a></code> ;</li>
<li>Issues et contributions : <a href="https://github.com/InseeFrLab/vizsurvey/issues" class="external-link uri">https://github.com/InseeFrLab/vizsurvey/issues</a> ;</li>
<li>Lectures méthodologiques : Groves &amp; al. (2009) <em>Survey
Methodology</em>, Lynn (2021) <em>Advances in Longitudinal Survey
Methodology</em>.</li>
</ul>
<p>Bonne exploration avec <strong>vizsurvey</strong> !</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Delclite, Adrien Mierop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
