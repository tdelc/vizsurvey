<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Préparer les données • vizsurvey</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Préparer les données">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">vizsurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/vizsurvey.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data-preparation.html">Préparer les données</a></li>
    <li><a class="dropdown-item" href="../articles/methods.html">Méthodologie et usages des fonctions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdelc/vizsurvey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Préparer les données</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tdelc/vizsurvey/blob/master/vignettes/data-preparation.Rmd" class="external-link"><code>vignettes/data-preparation.Rmd</code></a></small>
      <div class="d-none name"><code>data-preparation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdelc/vizsurvey" class="external-link">vizsurvey</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Cette vignette présente la préparation des données nécessaires à
l’utilisation de {vizsurvey} via l’appel
<code>runVizsurvey_from_folder</code>. L’objectif est de permettre une
utilisation régulière et structurée de l’outil au sein d’une équipe
gérant plusieurs enquêtes.</p>
<p>Dans ce contexte, lancer manuellement l’interface pour chaque base de
données devient rapidement fastidieux. De plus, le calcul des écarts,
notamment lorsqu’ils sont ventilés par domaine ou par groupe, peut
s’avérer coûteux en ressources.</p>
<p>Pour faciliter ce processus, {vizsurvey} propose plusieurs fonctions
de préparation automatisée. Cette vignette en décrit le fonctionnement
pas à pas, depuis la structuration des fichiers jusqu’à la génération
des objets nécessaires au lancement de l’application.</p>
</div>
<div class="section level2">
<h2 id="préparer-vos-données">Préparer vos données<a class="anchor" aria-label="anchor" href="#pr%C3%A9parer-vos-donn%C3%A9es"></a>
</h2>
<div class="section level3">
<h3 id="structure-simple-un-seul-répertoire">Structure simple : un seul répertoire<a class="anchor" aria-label="anchor" href="#structure-simple-un-seul-r%C3%A9pertoire"></a>
</h3>
<p>Le fichier de votre base de données doit pouvoir être lu par la
fonction <code><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">data.table::fread</a></code>. Cette fonction reconnaît
automatiquement les formats standards (CSV, TSV, etc.). Placez votre
fichier dans un répertoire dédié, où il sera le <strong>seul fichier de
ce type.</strong></p>
<p>Si votre enquête comporte plusieurs fichiers (par exemple un fichier
par année ou par pays, comme pour l’enquête SILC), vous pouvez les
placer dans un même répertoire. Tous les fichiers doivent toutefois
contenir les mêmes variables que celles indiquées dans le fichier de
configuration, et être au même format. De plus, aucun autre fichier de
ce type ne doit être présent dans le répertoire.</p>
<div class="section level4">
<h4 id="fichier-de-configuration-de-lenquête">Fichier de configuration de l’enquête<a class="anchor" aria-label="anchor" href="#fichier-de-configuration-de-lenqu%C3%AAte"></a>
</h4>
<p>Chaque répertoire de données doit contenir un fichier de
configuration nommé <code>config.txt</code>. Ce fichier indique à
{vizsurvey} comment interpréter et structurer vos données. Il doit
comporter les éléments suivants :</p>
<pre><code>name_survey = 

vars_discretes =
vars_continous =

var_domain = 
var_group = 

var_itw = </code></pre>
<ul>
<li><p><code>name_survey</code> : nom de l’enquête (utile pour
identifier les fichiers) ;</p></li>
<li><p><code>vars_discretes</code> : variables à traiter comme
catégorielles ;</p></li>
<li><p><code>vars_continous</code> : variables à traiter comme continues
;</p></li>
<li><p><code>var_domain</code> : variable de domaine utilisée pour
ventiler les calculs (exemple : année) ;</p></li>
<li><p><code>var_group</code> : variable de groupe permettant une
ventilation supplémentaire (exemple : province). Les calculs seront
également produits sans distinction de groupe ;</p></li>
<li><p><code>var_itw</code> : variable d’identifiant des
enquêteur·rices.</p></li>
</ul>
<p>Le fichier peut être créé manuellement, ou généré automatiquement à
l’aide de la fonction <code>create_config</code>. Voici l’exemple pour
les fichiers ménages de l’enquête SILC, avec l’année
(<code>HB010</code>) comme domaine et la province (<code>HB020</code>)
comme groupe :</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_config.html">create_config</a></span><span class="op">(</span></span>
<span>  folder_path <span class="op">=</span> <span class="st">"inst/extdata/SILC/HFILE"</span>,</span>
<span>  name_survey <span class="op">=</span> <span class="st">"SILC-H"</span>,</span>
<span>  var_domain  <span class="op">=</span> <span class="st">"HB010"</span>,</span>
<span>  var_group   <span class="op">=</span> <span class="st">"HB020"</span>,</span>
<span>  var_itw     <span class="op">=</span> <span class="st">"NR_ITW"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Les variables discrètes et continues ne doivent être précisées que si
la fonction <code>classify_df</code> identifie mal leur type. Cette
fonction détermine automatiquement le type de chaque variable, à partir
du format et du nombre de modalités. Le seuil de classification d’une
variable comme catégorielle est fixé par défaut à 15.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/classify_df.html">classify_df</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;   variable     type      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Petal.Length Continuous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Petal.Width  Continuous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Sepal.Length Continuous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Sepal.Width  Continuous</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Species      Modal</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="préparation-de-lenquête">Préparation de l’enquête<a class="anchor" aria-label="anchor" href="#pr%C3%A9paration-de-lenqu%C3%AAte"></a>
</h4>
<p>Une fois la configuration en place, {vizsurvey} peut calculer
<strong>en amont</strong> toutes les statistiques nécessaires au suivi
de l’enquête. La fonction <code>prepa_survey</code> utilise le dossier
contenant les données et le fichier <code>config.txt</code> pour
produire :</p>
<ul>
<li><p>Par domaine, Les statistiques descriptives de chaque variable
;</p></li>
<li><p>Par domaine, pour chaque variable, les écarts de chaque
enquêteur·rice avec le reste du domaine</p></li>
<li><p>Par domaine, par groupe, pour chaque variable, les écarts de
chaque enquêteur·rice avec le reste du groupe dans le domaine</p></li>
</ul>
<p>Par défaut, <code>prepa_survey</code> recherche les fichiers CSV du
répertoire, mais l’argument <code>file_pattern</code> permet d’adapter
ce comportement. Un fichier <code>global.rda</code> est ensuite généré
dans le même dossier : c’est lui qui sera utilisé par l’interface
interactive.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prepa_survey.html">prepa_survey</a></span><span class="op">(</span></span>
<span>  folder_path  <span class="op">=</span> <span class="st">"inst/extdata/SILC/HFILE"</span>,</span>
<span>  file_pattern <span class="op">=</span> <span class="st">"*.csv"</span><span class="op">)</span></span></code></pre></div>
<p>L’application peut ensuite être lancée simplement à l’aide de :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runVizsurvey_from_folder.html">runVizsurvey_from_folder</a></span><span class="op">(</span><span class="st">"inst/extdata/SILC/HFILE"</span>,depth_folder <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="structure-double-plusieurs-répertoires">Structure double : plusieurs répertoires<a class="anchor" aria-label="anchor" href="#structure-double-plusieurs-r%C3%A9pertoires"></a>
</h3>
<p>Si vous gérez plusieurs enquêtes, vous pouvez créer les répertoires
côte-à-côte et appeler la fonction <code>prepa_surveys</code>. Cette
fonction agit comme un wrapper de <code>prepa_survey</code> et applique
automatiquement la préparation à tous les répertoires enfants du chemin
spécifié. Dans ce cas, il faut indiquer
<code>depth_folder = 2</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prepa_surveys.html">prepa_surveys</a></span><span class="op">(</span>folder_path  <span class="op">=</span> <span class="st">"inst/extdata/SILC"</span>,depth_folder <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Vous pouvez ensuite lancer l’interface en précisant le même niveau de
profondeur :</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runVizsurvey_from_folder.html">runVizsurvey_from_folder</a></span><span class="op">(</span><span class="st">"inst/extdata/SILC"</span>,depth_folder <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="structure-triple-plusieurs-niveaux-de-répertoires">Structure triple : plusieurs niveaux de répertoires<a class="anchor" aria-label="anchor" href="#structure-triple-plusieurs-niveaux-de-r%C3%A9pertoires"></a>
</h3>
<p>Il est également possible de gérer une arborescence complète
d’enquêtes, avec plusieurs niveaux hiérarchiques. Voici un exemple de
structure de répertoires attendue :</p>
<pre><code>extdata/
  ├── ESS/
  │   ├── ESS9/
  │   │   └── ...
  │   └── ESS10/
  │       └── ...
  └── SILC/
      ├── HFILE/
      │   └── ...
      └── PFILE/
          └── ...</code></pre>
<p>Chaque sous-répertoire doit comporter son propre
<code>config.txt</code>, puis vous pouvez exécuter la préparation
globale :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">prepa_surveys</span>(<span class="at">folder_path  =</span> <span class="st">"inst/extdata"</span>,<span class="at">depth_folder =</span> <span class="dv">3</span>)<span class="er">}</span></span></code></pre></div>
<p>Enfin, l’interface est lancée avec la même profondeur :</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/runVizsurvey_from_folder.html">runVizsurvey_from_folder</a></span><span class="op">(</span><span class="st">"inst/extdata"</span>,depth_folder <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Si les données sont mises à jour, par exemple durant le terrain, il
suffit d’exécuter une nouvelle fois la fonction
<code>prepa_surveys</code> pour obtenir une version mise à jour de
l’objet <code>global.rda</code>, et ainsi une mise à jour complète de
l’interface interactive.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>La préparation des données constitue une étape essentielle avant
d’utiliser pleinement {vizsurvey} dans le cadre d’un organisme
organisant des enquêtes au quotidien. Elle permet d’optimiser la
fluidité de l’application et de garantir que tous les responsables
d’enquête analyse les mêmes fichiers mis à jour.</p>
<p>Une fois les fichiers structurés, configurés et préparés, chaque
lancement de l’interface devient immédiat : toutes les statistiques
nécessaires sont déjà calculées et stockées dans le fichier
<code>global.rda</code>. Cette approche assure une réutilisation
efficace des données, quel que soit le nombre d’enquêtes ou la
complexité de leur arborescence. Elle facilite aussi le travail
collaboratif au sein d’une équipe : chaque membre peut explorer les
résultats sans devoir maîtriser R.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Delclite.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
